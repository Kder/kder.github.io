<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from www.kder.info/compress-each-subdir-to-zip.html?code=aglzfmtkZXJocmRyDQsSBUVudHJ5GPKoAgw by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 18 Mar 2017 09:36:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">

<meta http-equiv="Content-Type" content="text/html;charset=utf-8;" />
<title> 将文件夹下所有文件及子目录分别压缩为zip - 可得博客 </title>
<link rel="stylesheet" href="themes/default/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="可得博客 RSS Feed" href="feed" />
<link rel="shortcut icon" href="favicon.ico" >
<link href="static/wlwmanifest.xml" type="application/wlwmanifest+xml" rel="wlwmanifest"/>
<script type="text/javascript" src="themes/default/rounded_corners_lite.inc.js"></script>
<script type="text/javascript" src="../ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script type="text/JavaScript">
window.onload = function()
{
settings = {
tl: { radius: 5 },
tr: { radius: 5 },
bl: { radius: 5 },
br: { radius: 5 },
antiAlias: true,
autoPad: true,
validTags: ["div"]
}
var myBoxObject = new curvyCorners(settings, "nifty");
myBoxObject.applyCornersToAll();
var myBoxObject = new curvyCorners(settings, "meta");
myBoxObject.applyCornersToAll();
var myBoxObject = new curvyCorners(settings, "sidebar");
myBoxObject.applyCornersToAll();
}
</script>

<meta name="generator" content="Micolog 0.743" />
</head>

<body>
<div id="main">
<div id="wrapper">

<div id="top">
<div id="logo"><h1><a href="index.html" title="可得博客">可得博客</a></h1>
</div>

<div id="menu">
<ul>
		<li class="page_item" >
			<a  href="index.html"  >首页</a>
		</li>
		<li class="page_item"><a href="pyproxyswitch.html" target="_self">PyProxySwitch</a></li><li class="page_item"><a href="about.html" target="_self">关于Kder</a></li>
    <li class="page_item" ><a href="feed">(RSS)</a></li>
    

    
      <li>
     
       <a href="https://www.google.com/accounts/ServiceLogin?service=ah&amp;passive=true&amp;continue=https://appengine.google.com/_ah/conflogin%3Fcontinue%3Dhttp://www.kder.info/admin&amp;ltmpl=gm&amp;shdf=ChALEgZhaG5hbWUaBEtkZXIMEgJhaCIUBOGrstSre1JVfn4GsJvDcpl5VzUoATIUOTufZGo6z_qRRki16VX3VZ6YDRg">Login</a>

     
         </li>


<li id="searchbox">

<form method="get" id="searchform" action="http://www.google.com/search">
		<input type="text" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" name="as_q" id="s" />
		<input type="image" src="themes/default/images/transparent.gif" id="go" alt="Search" title="Search" />
		<input name="as_sitesearch" value="www.kder.info" type="hidden">

		</form>

</li>

</ul>
</div>

</div>
<div id="content">
<div id="split">



<div class="ctop"></div>
<div class="box">



<div id="post-aglzfmtkZXJocmRyDQsSBUVudHJ5GPKoAgw">
<div class="nifty"><h2><a href="compress-each-subdir-to-zip.html" rel="bookmark" title="Permanent Link to 将文件夹下所有文件及子目录分别压缩为zip">将文件夹下所有文件及子目录分别压缩为zip</a> <span class="date">十月 21st, 2009</span></h2></div>
<div class="en_body">

<p>这是一个批处理程序（bat脚本），功能是：将一个文件夹下面的所有子文件夹和文件分别压缩为zip文件（不递归子目录）  Dir_to_Zip.bat</p>
<p>
<pre class="brush: plain;fontsize: 100; first-line: 1; ">    @echo off
    rem 关闭回显
    %~d1
    rem 转到目标目录所在盘符
    cd %~f1
    rem 转到目标目录
    path=D:\Program Files\7-Zip;C:\Program Files\7-Zip
    rem 设置7-zip的路径
    for /F "tokens=*" %%i in ('dir %1 /A /B') do 7z a -tzip "%%i".zip "%%i"
    rem dir列出子目录及文件列表，for遍历每个对象，do调用7-zip压缩
</pre>
</p>
<p><strong>备注：<!--more--></strong> 需要系统中安装有7zip，其他压缩软件如果支持命令行也可参考此做法，do后面的命令参数也可自定义，例如将格式改为７ｚ或者调整压缩级别等等</p>
<p>其实实现这个功能早就有更好的软件了&mdash;&mdash;老马的作品Zip2Dir，这里有好多他的原创作品，都是很实用的小工具： <a href="http://www.comicer.com/stronghorse/software/index.htm">http://www.comicer.com/stronghorse/software/index.htm</a></p>


	
                <h4>您也许想再看看这些:</h4>
                  <ul>
                
                  <li><a href="PyProxySwitch3.5.2-released.html">PyProxySwitch3.5.2发布，修复启动时找不到模块问题</a></li>
                
                  <li><a href="PyProxySwitch-351.html">PyProxySwitch3.5.1发布</a></li>
                
                  <li><a href="pyproxyswitch-3.5-released.html">增加图形界面批量添加代理功能：PyProxySwitch3.5发布</a></li>
                
                  <li><a href="pyproxyswitch-3.3.1-released.html">新增图形设置界面，PyProxySwitch 3.3.1发布</a></li>
                
                  <li><a href="batch-terminate-processes.html">用bat脚本批量结束进程</a></li>
                
                </ul>
                
</div>
<div class="meta">
标签: <a href="tag/%e7%bc%96%e7%a8%8b.html">编程</a> <br><br>  分类  <a href="category/thought.html">经验体会</a>  | 

<div style="padding:2px 0">
Trackback:<a href='compress-each-subdir-to-zipa24d.html?code=aglzfmtkZXJocmRyDQsSBUVudHJ5GPKoAgw'>http://www.kder.info/compress-each-subdir-to-zip.html?code=aglzfmtkZXJocmRyDQsSBUVudHJ5GPKoAgw</a>
</div>

</div>

</div>
</div>
<div class="cbottom"></div>
<div class="space"></div>


<div class="ctop"></div>
<div class="box">

<!-- You can start editing here. -->



	<h3 id="comments">4 回复 &#8220;将文件夹下所有文件及子目录分别压缩为zip&#8221;</h3>

	<ol class="commentlist">

	

		<li class="alt1" id="comment-79001">
			<div class="gravatar"><img height="50" width="50" class="avatar avatar-50" src="../i1.wp.com/www.kder.info/static/images/homsar.jpg?s=50&amp;r=G&amp;d=http%3A%2F%2Fwww.kder.info%2Fstatic%2Fimages%2Fhomsar.jpeg" alt=""/></div>
			<div class="comments"><a href="None.html" target="_blank">zach</a> 于 <small class="commentmetadata"><a href="#comment-79001" title="">2010-10-02  10:43</a> </small>

			<br />

			<p>不错.\\^✿^//<br />其实如果7zip把这事给干了就更好了，记得winrar可以。<br /></p>

			</div>
			<div class="clear"></div>

		</li>



	

		<li class="alt" id="comment-80001">
			<div class="gravatar"><img height="50" width="50" class="avatar avatar-50" src="../i1.wp.com/www.kder.info/static/images/homsar.jpg?s=50&amp;r=G&amp;d=http%3A%2F%2Fwww.kder.info%2Fstatic%2Fimages%2Fhomsar.jpeg" alt=""/></div>
			<div class="comments"><a href="None.html" target="_blank">Kder</a> 于 <small class="commentmetadata"><a href="#comment-80001" title="">2010-10-04  21:22</a> </small>

			<br />

			<p>winrar的确有这个功能：右键－“添加到压缩文件”－“文件”－选中“把每个文件放到单独的压缩文件中”就可以了。这里有图说明：http://oneyicn.gobaiyi.com/archives/1661/</p>

			</div>
			<div class="clear"></div>

		</li>



	

		<li class="alt1" id="comment-87001">
			<div class="gravatar"><img height="50" width="50" class="avatar avatar-50" src="../i1.wp.com/www.kder.info/static/images/homsar.jpg?s=50&amp;r=G&amp;d=http%3A%2F%2Fwww.kder.info%2Fstatic%2Fimages%2Fhomsar.jpeg" alt=""/></div>
			<div class="comments"><a href="http://sailchou.3322.org/" target="_blank">sailchou</a> 于 <small class="commentmetadata"><a href="#comment-87001" title="">2010-11-22  20:04</a> </small>

			<br />

			<p>我是来顶可得儿的~~~</p>

			</div>
			<div class="clear"></div>

		</li>



	

		<li class="alt" id="comment-88001">
			<div class="gravatar"><img height="50" width="50" class="avatar avatar-50" src="../www.gravatar.com/avatar/c9d983fb4f825f7f45fd43646cf891820a27.jpeg?s=50&amp;r=G&amp;d=http%3A%2F%2Fwww.kder.info%2Fstatic%2Fimages%2Fhomsar.jpeg" alt=""/></div>
			<div class="comments"><a href="index.html" target="_blank">Kder</a> 于 <small class="commentmetadata"><a href="#comment-88001" title="">2010-11-24  16:42</a> </small>

			<br />

			<p>@sailchou 谢谢支持哈～</p>

			</div>
			<div class="clear"></div>

		</li>



	

	</ol>







</div>
<div class="cbottom"></div>
<div class="space"></div>


</div>
<div class="sidebar">
<ul>

<li>
	<h2>公告</h2>
	暂时关闭评论功能，欢迎通过邮件和微博联系我：<br/>Gmail:&nbsp; kderlin （首选）<br/>
新浪微博：kder
</li>

<li>
	<h2>评论</h2>
	<ul>
        
        <li><a href="PyProxySwitch3.5.2-released.html#comment-117001">Kder:@PPSlove: 1.我手边没有64...</a> </li>
        
        <li><a href="PyProxySwitch3.5.2-released.html#comment-116002">PPSlove:测试了http，比如代理看视频的时候，播...</a> </li>
        
        <li><a href="PyProxySwitch3.5.2-released.html#comment-116001">PPSlove:另外密码如果能够用星号表示最好了，有时候...</a> </li>
        
        <li><a href="PyProxySwitch3.5.2-released.html#comment-115001">PPSlove:博主好， 程序很好很强大，感谢！不过在...</a> </li>
        
        <li><a href="wordpress-spaces-firefox-ie.html#comment-111001">Kder:@小木 看来是浏览器之间的兼容性问题了…...</a> </li>
        
	</ul>
</li>

<li>
 <h2>分类</h2>
  <ul>
 	
  <li>	<a href="category/share.html">资源分享(22)</a></li>
 	
  <li>	<a href="category/solutions.html">解决问题(26)</a></li>
 	
  <li>	<a href="category/thought.html">经验体会(28)</a></li>
 	
  <li>	<a href="category/uncategorized.html">杂七杂八(20)</a></li>
 	
 	</ul>

</li>

<li>
<h2>链接</h2>
<ul>

<li><a href="http://pyproxyswitch.kder.info/">PyProxySwitch项目主页</a></li>

<li><a href="http://xuming.net/">徐明的博客</a></li>

<li><a href="http://xuming.net/">Xuming&#39;s blog</a></li>

<li><a href="http://eric.cloud-mes.com/">Eric Guo&#39;s blog</a></li>

<li><a href="http://weibo.com/kder">Kder的微博</a></li>


</ul>
</li>


</ul>
</div>



</div>
</div>
</div>


<div id="push"></div>
<div id="footer">

	<div class="footer">
			<p class="fooleft">可得博客 由 <a href="http://xuming.net/">Micolog</a> 构建. 主题由 <a href="http://bob.my/" title="Simple">Bob</a> 提供
		</p>
		<p class="fooright"><a href="#top" title="Top">回页首</a></p>
	</div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9499950-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><!--Powered by micolog 0.743-->
</div>
</div>
</body>

<!-- Mirrored from www.kder.info/compress-each-subdir-to-zip.html?code=aglzfmtkZXJocmRyDQsSBUVudHJ5GPKoAgw by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 18 Mar 2017 09:36:34 GMT -->
</html>